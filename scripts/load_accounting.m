%% Import data from spreadsheet
% Script for importing data from the following spreadsheet:
%
%    Workbook: /home/atomic/git/COGS109_Final/scripts/Wealth_Accounting_sorted_according_to_indicator.xlsx
%    Worksheet: Data
%
% To extend the code for use with different selected data or a different
% spreadsheet, generate a function instead of a script.

% Auto-generated by MATLAB on 2016/11/24 23:08:10

%% Import the data
[~, ~, raw] = xlsread('Wealth_Accounting_sorted_according_to_indicator.xlsx','Data');
raw = raw(2:end,[1:4,6:end]);
raw(cellfun(@(x) ~isempty(x) && isnumeric(x) && isnan(x),raw)) = {''};
cellVectors = raw(:,[1,2,3,4]);
raw = raw(:,[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]);

%% Replace non-numeric cells with NaN
R = cellfun(@(x) ~isnumeric(x) && ~islogical(x),raw); % Find non-numeric cells
raw(R) = {NaN}; % Replace non-numeric cells

%% Create output variable
data = reshape([raw{:}],size(raw));

%% Allocate imported array to column variable names
CountryName = cellVectors(:,1);
CountryCode = cellVectors(:,2);
IndicatorName = cellVectors(:,3);
IndicatorCode = cellVectors(:,4);

% the 'data' matrix contains the yearly values extracted from Wealth
% accounting starting at 1971, but to plot according to certain attributes, you have to
% index it manually

% NOTE: Year 1970 is not included, it has too many empty values that matlab
% mistook it for cell data instead of double, so only year from 1971-2014
% 1971 correponds to data(:,1), 2014 correspond to data(:,44)

y1971 = data(:,1);
y1972 = data(:,2);
y1973= data(:,3);
y1974 = data(:,4);
% etc.....
VarName10 = data(:,5);
VarName11 = data(:,6);
VarName12 = data(:,7);
VarName13 = data(:,8);
VarName14 = data(:,9);
VarName15 = data(:,10);
VarName16 = data(:,11);
VarName17 = data(:,12);
VarName18 = data(:,13);
VarName19 = data(:,14);
VarName20 = data(:,15);
VarName21 = data(:,16);
VarName22 = data(:,17);
VarName23 = data(:,18);
VarName24 = data(:,19);
VarName25 = data(:,20);
VarName26 = data(:,21);
VarName27 = data(:,22);
VarName28 = data(:,23);
VarName29 = data(:,24);
VarName30 = data(:,25);
VarName31 = data(:,26);
VarName32 = data(:,27);
VarName33 = data(:,28);
VarName34 = data(:,29);
VarName35 = data(:,30);
VarName36 = data(:,31);
VarName37 = data(:,32);
VarName38 = data(:,33);
VarName39 = data(:,34);
VarName40 = data(:,35);
VarName41 = data(:,36);
VarName42 = data(:,37);
VarName43 = data(:,38);
VarName44 = data(:,39);
VarName45 = data(:,40);
VarName46 = data(:,41);
VarName47 = data(:,42);
VarName48 = data(:,43);
VarName49 = data(:,44);

%% Try plotting
% test plotting couple annual value of EAS_net_national_income
hold;
plot( data(4,:) ); % EAS net annual income
plot( data(5,:) ); % EMU net annual income
plot( data(6,:) ); % ECS net annual income
hold off;

% Note: 1 to 741 are net annual income 
% Alternatively, regenerate the import scripts to only include things we
% are interested in (forest depletion, etc) or just index it manually
% ex: look for what row the data starts and slice it from there

%% Clear temporary variables
clearvars data raw cellVectors R;